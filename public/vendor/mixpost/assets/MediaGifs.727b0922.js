import{r as h,h as V,x as H,a8 as T,H as re,y as O,z as ie,o as s,c as v,F as D,e as Q,g as j,d as N,t as Y,b as $,n as F,k as U,I as ce,f as w,U as q,ab as z,a as m,ac as ue,u as o,w as f,_ as X,M as Z,l as ee}from"./app.986b6adc.js";import{_ as A,a as te}from"./NoResult.5b7eda6b.js";import{a as de,_ as se}from"./SearchInput.60812392.js";import{_ as le}from"./Alert.b6711ff4.js";import{_ as ne}from"./PrimaryButton.f86bfcb5.js";import{l as ae,k as fe}from"./helpers.73aae10f.js";import{u as me}from"./useNotifications.8793251d.js";const K=(l="mixpost.media.fetchUploads",r={})=>{const{notify:n}=me(),d=h("uploads"),y=V(()=>({uploads:"Upload",stock:"Stock Photos",gifs:"GIFs"})),p=h(!1),g=h(!1),C=h(!1),x=h(1),c=h([]),i=h(null),b=h(""),a=h([]),S=_=>{const e=a.value.findIndex(t=>t.id===_.id);e<0&&!_.hasOwnProperty("error")&&a.value.push(_),e>=0&&a.value.splice(e,1)},k=()=>{a.value=[]},u=_=>a.value.findIndex(t=>t.id===_.id)!==-1,M=(_=!0)=>{!x.value||(T.start(),axios.get(route(l,r),{params:{page:x.value,keyword:b.value}}).then(function(e){const t=e.data.links.next;t&&(x.value=e.data.links.next.split("?page=")[1]),t||(x.value=0),_||(c.value=e.data.data),_&&(c.value=[...c.value,...e.data.data])}).catch(()=>{n("error","Error retrieving media. Try again!")}).finally(()=>{T.done(),p.value=!0}))},B=(_,e)=>{g.value=!0,T.start(),axios.post(route("mixpost.media.download",r),{items:_}).then(t=>{e(t)}).catch(()=>{n("error","Error downloading media. Try again!")}).finally(()=>{g.value=!1,T.done(),T.remove()})},J=_=>{c.value=c.value.filter(e=>!_.includes(e.id))},P=(_,e)=>{C.value=!0,T.start(),axios.delete(route("mixpost.media.delete",r),{data:{items:_}}).then(()=>{e()}).catch(()=>{n("error","Error deleting media. Try again!")}).finally(()=>{C.value=!1,T.done(),T.remove()})},G=()=>{const _=new IntersectionObserver(e=>{e[0].isIntersecting&&M()});re(()=>{_.observe(i.value)})};return H(b,ae.exports.debounce(()=>{x.value=1,M(!1)},300)),{activeTab:d,tabs:y,isLoaded:p,isDownloading:g,isDeleting:C,keyword:b,page:x,items:c,endlessPagination:i,selected:a,downloadExternal:B,deletePermanently:P,removeItems:J,createObserver:G,toggleSelect:S,deselectAll:k,isSelected:u}};let ve=(l=21)=>crypto.getRandomValues(new Uint8Array(l)).reduce((r,n)=>(n&=63,n<36?r+=n.toString(36):n<62?r+=(n-26).toString(36).toUpperCase():n>62?r+="-":r+="_",r),"");const pe=["data-column"],E={__name:"Masonry",props:{items:{type:Array,required:!0},columns:{type:Number,default:3}},setup(l){const r=l,n=h(null),d=h([]),y=h(!1);O(()=>{c(),window.addEventListener("resize",p)}),ie(()=>{window.removeEventListener("resize",p)});const p=ae.exports.debounce(()=>{d.value.length!==g().length&&c()},300),g=()=>{let i=r.columns;fe().width<=768&&(i=2);const b=[];for(let a=0;a<i;a++)b.push({i:a,indexes:[]});return b},C=i=>{const b=i%d.value.length;d.value[b].indexes.push(i)},x=()=>{for(let i=0;i<r.items.length;i++)C(i)},c=()=>{y.value=!1,d.value.splice(0),d.value.push(...g()),y.value=!0,x()};return H(()=>r.items,()=>{c()}),(i,b)=>(s(),v("div",{class:F(["flex -m-1",{"opacity-0":!y.value}])},[(s(!0),v(D,null,Q(d.value,(a,S)=>(s(),v("div",{class:"flex flex-col grow basis-0 px-1",key:S},[(s(!0),v(D,null,Q(a.indexes,k=>(s(),v("div",{class:"py-1",key:k,ref_for:!0,ref:`item_${k}`},[j(i.$slots,"default",{item:l.items[k],index:k},()=>[N(Y(l.items[k]),1)])]))),128)),$("div",{class:"grow -mt-20 pt-20 min-h-[100px] -z-10",ref_for:!0,ref_key:"bottomRef",ref:n,"data-column":S},null,8,pe)]))),128))],2))}},L={__name:"MediaSelectable",props:{active:{type:Boolean,default:!1}},emits:["click"],setup(l){return(r,n)=>(s(),v("div",{onClick:n[0]||(n[0]=d=>r.$emit("click")),class:"w-full relative cursor-pointer box-border"},[j(r.$slots,"default"),$("div",{class:F(["absolute flex items-center justify-center top-0 right-0 mr-sm mt-sm w-7 h-7 rounded-full border border-white",{"bg-indigo-500":l.active,"bg-black bg-opacity-20":!l.active}])},[l.active?(s(),U(ce,{key:0,class:"text-white"})):w("",!0)],2)]))}},ge=["onDrop"],_e={class:"relative flex flex-col justify-center"},he=$("div",{class:"text-center mb-1"},[N("Drag & drop files here, or "),$("label",{for:"browse",class:"cursor-pointer text-indigo-500 hover:text-indigo-700 active:text-indigo-700 focus:outline-none focus:text-indigo-700 transition-colors ease-in-out duration-200"}," Browse ")],-1),ye={class:"text-sm text-gray-400 text-center"},xe=["accept"],be={key:0,class:"mt-lg"},ke={__name:"UploadMedia",props:{maxSelection:{type:Number,default:1},combinesMimeTypes:{type:String,default:""},selected:{type:Array,default:[]},toggleSelect:{type:Function},isSelected:{type:Function},columns:{type:Number,default:3}},emits:["mediaSelect"],setup(l,{emit:r}){const n=l,d=q().props.mixpost.mime_types,y=h(null),p=h(!1),g=e=>{if(c.value)return;p.value=!1;const t=x(e.dataTransfer.files);t.length&&P(t)},C=e=>{const t=x(e.target.files);t.length&&(y.value.value=null,P(t))},x=e=>Array.from(e).filter(t=>d.includes(t.type)),c=h(!1),i=h([]),b=h([]),a=h({});H(a,()=>{S(),c.value=Object.keys(a.value).length>0});const S=()=>{a.value.handler&&a.value.handler()},k=e=>{i.value.push(e),Object.keys(a.value).length===0&&u()},u=e=>{Object.keys(a.value).length>0&&(J(a.value,e),n.toggleSelect&&n.toggleSelect(e)),i.value.length>0?(M(i.value[0]),B()):M({})},M=e=>{a.value=e},B=()=>{i.value.shift()},J=(e,t)=>{b.value.push(Object.assign(e,{media:t}))},P=e=>{e.forEach(t=>{k({id:ve(),handler:async()=>{await G(t).then(I=>{u(I)}).catch(I=>{u({name:t.name,error:I.response.data.message})})}})})},G=e=>{const t=new FormData;return t.append("file",e),new Promise((I,W)=>{axios.post(route("mixpost.media.upload"),t).then(function(R){I(R.data)}).catch(function(R){W(R)})})},_=V(()=>b.value.filter(()=>!0).reverse());return h([]),(e,t)=>(s(),v(D,null,[$("div",{onDragenter:t[2]||(t[2]=z(I=>p.value=!c.value,["prevent"])),onDrop:z(g,["prevent"]),onDragover:t[3]||(t[3]=z(()=>{},["prevent"])),class:F([{"border-gray-700 bg-white":!p.value,"border-cyan-500 bg-cyan-50":p.value},"relative w-full flex items-center justify-center rounded-lg p-10 border-2 border-dashed transition-colors ease-in-out duration-200"])},[$("div",_e,[p.value?(s(),v("div",{key:0,onDragleave:t[0]||(t[0]=z(I=>p.value=!1,["prevent"])),onDragover:t[1]||(t[1]=z(()=>{},["prevent"])),class:"w-full h-full absolute"},null,32)):w("",!0),m(ue,{class:F([{"text-stone-700":!p.value,"text-cyan-500":p.value},"!w-16 !h-16 mx-auto mb-xs transition-colors ease-in-out duration-200"])},null,8,["class"]),he,$("div",ye,Y(o(d).join(", ")),1)]),c.value?(s(),U(de,{key:0,size:"xl",class:"rounded-lg"})):w("",!0)],42,ge),$("input",{ref_key:"input",ref:y,id:"browse",type:"file",accept:o(d).join(","),multiple:"multiple",class:"hidden",onChange:C},null,40,xe),_.value.length?(s(),v("div",be,[m(E,{items:_.value,columns:l.columns},{default:f(({item:I})=>[m(L,{active:l.isSelected(I.media),onClick:W=>l.toggleSelect(I.media)},{default:f(()=>[m(A,{media:I.media},null,8,["media"])]),_:2},1032,["active","onClick"])]),_:1},8,["items","columns"])])):w("",!0)],64))}},we={},$e={class:"w-full text-lg"};function Se(l,r){return s(),v("div",$e,[j(l.$slots,"default")])}const Ce=X(we,[["render",Se]]),Ge={__name:"MediaUploads",props:{columns:{type:Number,default:3}},setup(l,{expose:r}){const{page:n,items:d,endlessPagination:y,selected:p,toggleSelect:g,deselectAll:C,removeItems:x,isSelected:c,createObserver:i}=K();return O(()=>{i()}),r({selected:p,deselectAll:C,removeItems:x}),(b,a)=>(s(),v(D,null,[m(ke,{"max-selection":4,"combines-mime-types":"",selected:o(p),toggleSelect:o(g),isSelected:o(c),columns:l.columns},null,8,["selected","toggleSelect","isSelected","columns"]),$("div",{class:F({"mt-lg":o(d).length})},[o(d).length?(s(),v(D,{key:0},[m(Ce,{class:"mb-4"},{default:f(()=>[N("Library")]),_:1}),m(E,{items:o(d),columns:l.columns},{default:f(({item:S})=>[S?(s(),U(L,{key:0,active:o(c)(S),onClick:k=>o(g)(S)},{default:f(()=>[m(A,{media:S},null,8,["media"])]),_:2},1032,["active","onClick"])):w("",!0)]),_:1},8,["items","columns"])],64)):w("",!0),$("div",{ref_key:"endlessPagination",ref:y,class:"-z-10 w-full"},null,512)],2)],64))}},Ie={},Ne={class:"absolute z-10 bottom-0 mb-xs left-0 ml-xs hidden group-hover:block"},De={class:"bg-white shadow-mix py-xs px-sm text-left rounded-md"};function Te(l,r){return s(),v("div",Ne,[$("div",De,[j(l.$slots,"default")])])}const oe=X(Ie,[["render",Te]]),Ue={key:0},Me={key:0,class:"mt-lg"},ze=$("div",null,"Image from Unsplash",-1),Fe=["href"],Re={__name:"MediaStock",props:{columns:{type:Number,default:3}},setup(l,{expose:r}){const n=V(()=>q().props.is_configured_service.unsplash),{isLoaded:d,keyword:y,page:p,items:g,endlessPagination:C,selected:x,toggleSelect:c,deselectAll:i,isSelected:b,createObserver:a}=K("mixpost.media.fetchStock");return O(()=>{n.value&&a()}),r({selected:x,deselectAll:i}),(S,k)=>(s(),v(D,null,[n.value?(s(),v("div",Ue,[m(se,{modelValue:o(y),"onUpdate:modelValue":k[0]||(k[0]=u=>Z(y)?y.value=u:null),placeholder:"Search Unsplash"},null,8,["modelValue"]),o(g).length?(s(),v("div",Me,[m(E,{items:o(g),columns:l.columns},{default:f(({item:u})=>[u?(s(),U(L,{key:0,active:o(b)(u),onClick:M=>o(c)(u)},{default:f(()=>[m(A,{media:u,class:"group"},{default:f(()=>[m(oe,null,{default:f(()=>[ze,$("div",null,[N("By "),$("a",{href:u.credit_url,target:"_blank",class:"link"},Y(u.name),9,Fe)])]),_:2},1024)]),_:2},1032,["media"])]),_:2},1032,["active","onClick"])):w("",!0)]),_:1},8,["items","columns"])])):w("",!0),o(d)&&!o(g).length?(s(),U(te,{key:1,class:"mt-lg"},{default:f(()=>[N("No images found.")]),_:1})):w("",!0),$("div",{ref_key:"endlessPagination",ref:C,class:"-z-10 w-full"},null,512)])):w("",!0),n.value?w("",!0):(s(),v(D,{key:1},[m(le,{variant:"warning",closeable:!1},{default:f(()=>[N(" You have not configured Unsplash service. ")]),_:1}),m(o(ee),{href:S.route("mixpost.services.index"),class:"block mt-md"},{default:f(()=>[m(ne,null,{default:f(()=>[N("Click to configure")]),_:1})]),_:1},8,["href"])],64))],64))}},Pe={key:0},Ve={key:0,class:"mt-lg"},He={__name:"MediaGifs",props:{columns:{type:Number,default:3}},setup(l,{expose:r}){const n=V(()=>q().props.is_configured_service.tenor),{isLoaded:d,keyword:y,page:p,items:g,endlessPagination:C,selected:x,toggleSelect:c,deselectAll:i,isSelected:b,createObserver:a}=K("mixpost.media.fetchGifs");return O(()=>{n.value&&a()}),r({selected:x,deselectAll:i}),(S,k)=>(s(),v(D,null,[n.value?(s(),v("div",Pe,[m(se,{modelValue:o(y),"onUpdate:modelValue":k[0]||(k[0]=u=>Z(y)?y.value=u:null),placeholder:"Search Tenor GIFs"},null,8,["modelValue"]),o(g).length?(s(),v("div",Ve,[m(E,{items:o(g),columns:l.columns},{default:f(({item:u})=>[u?(s(),U(L,{key:0,active:o(b)(u),onClick:M=>o(c)(u)},{default:f(()=>[(s(),U(A,{media:u,key:u.id,class:"group"},{default:f(()=>[m(oe,null,{default:f(()=>[N(" GIF from Tenor ")]),_:1})]),_:2},1032,["media"]))]),_:2},1032,["active","onClick"])):w("",!0)]),_:1},8,["items","columns"])])):w("",!0),o(d)&&!o(g).length?(s(),U(te,{key:1,class:"mt-lg"},{default:f(()=>[N("No GIFs found.")]),_:1})):w("",!0),$("div",{ref_key:"endlessPagination",ref:C,class:"-z-10 w-full"},null,512)])):w("",!0),n.value?w("",!0):(s(),v(D,{key:1},[m(le,{variant:"warning",closeable:!1},{default:f(()=>[N(" You have not configured Tenor service. ")]),_:1}),m(o(ee),{href:S.route("mixpost.services.index"),class:"block mt-md"},{default:f(()=>[m(ne,null,{default:f(()=>[N("Click to configure")]),_:1})]),_:1},8,["href"])],64))],64))}};export{Ge as _,Re as a,He as b,K as u};
